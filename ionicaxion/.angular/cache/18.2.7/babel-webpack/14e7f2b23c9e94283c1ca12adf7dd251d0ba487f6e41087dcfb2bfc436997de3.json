{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/a.campos/source/repos/ionicaxion/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _LoginPage;\nimport { RecuperarContrasenaModalComponent } from '../recuperar-contrasena-modal/recuperar-contrasena-modal.component'; // Importa el modal\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/api.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"@angular/forms\";\n// Define la interfaz aquí\nexport class LoginPage {\n  constructor(apiService, router,\n  // Inyecta Router\n  toastController, modalController // Inyecta ToastController\n  ) {\n    this.apiService = apiService;\n    this.router = router;\n    this.toastController = toastController;\n    this.modalController = modalController;\n    this.phoneNumber = \"\";\n    this.password = \"\";\n  }\n  recoverPassword() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const modal = yield _this.modalController.create({\n        component: RecuperarContrasenaModalComponent\n      });\n      return yield modal.present();\n    })();\n  }\n  login() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const loginData = {\n        phoneNumber: _this2.phoneNumber,\n        password: _this2.password\n      };\n      console.log('LoginData from API:', loginData); // <-- Agregado aquí\n      console.log('Login Data:', JSON.stringify(loginData));\n      _this2.apiService.login(loginData).subscribe( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (response) {\n          console.log('Response from API:', response);\n          if (response && response.message === 'Login successful.') {\n            // Almacena el nombre completo del usuario en localStorage\n            localStorage.setItem('fullName', response.fullName);\n            _this2.router.navigate(['/home']); // Navega a la página home\n          } else {\n            // Muestra un toast con el error\n            const toast = yield _this2.toastController.create({\n              message: response.message || 'Error al iniciar sesión',\n              duration: 2000,\n              color: 'danger'\n            });\n            toast.present();\n          }\n        });\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n}\n_LoginPage = LoginPage;\n_LoginPage.ɵfac = function LoginPage_Factory(__ngFactoryType__) {\n  return new (__ngFactoryType__ || _LoginPage)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.ToastController), i0.ɵɵdirectiveInject(i3.ModalController));\n};\n_LoginPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _LoginPage,\n  selectors: [[\"app-login\"]],\n  decls: 29,\n  vars: 2,\n  consts: [[2, \"background-color\", \"#D1117E\"], [2, \"padding\", \"20px\", \"background-image\", \"url(assets/fondo_general.png)\"], [2, \"text-align\", \"center\", \"margin-bottom\", \"20px\"], [\"src\", \"assets/logo.png\", \"alt\", \"Logo de Axion\", 2, \"max-width\", \"100%\", \"height\", \"auto\"], [2, \"color\", \"white\", \"margin\", \"0\"], [2, \"color\", \"white\", \"text-align\", \"center\"], [3, \"ngSubmit\"], [\"position\", \"floating\"], [\"name\", \"phoneNumber\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"name\", \"password\", \"type\", \"password\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [2, \"text-align\", \"center\", \"margin\", \"10px 0\"], [\"href\", \"#\", 2, \"color\", \"white\", 3, \"click\"], [\"expand\", \"full\", \"type\", \"submit\", 2, \"background-color\", \"black\", \"color\", \"white\"], [\"expand\", \"full\", \"routerLink\", \"/registro\", 2, \"background-color\", \"#D1117E\", \"color\", \"white\"]],\n  template: function LoginPage_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\", 0)(2, \"ion-title\");\n      i0.ɵɵtext(3, \"Login\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(4, \"ion-content\", 1)(5, \"div\", 2);\n      i0.ɵɵelement(6, \"img\", 3);\n      i0.ɵɵelementStart(7, \"h2\", 4);\n      i0.ɵɵtext(8, \"SANTA LUC\\u00CDA\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"h3\", 4);\n      i0.ɵɵtext(10, \"AXION SHOP\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(11, \"h4\", 5);\n      i0.ɵɵtext(12, \"Bienvenido\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"form\", 6);\n      i0.ɵɵlistener(\"ngSubmit\", function LoginPage_Template_form_ngSubmit_13_listener() {\n        return ctx.login();\n      });\n      i0.ɵɵelementStart(14, \"ion-item\")(15, \"ion-label\", 7);\n      i0.ɵɵtext(16, \"N\\u00FAmero de celular\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(17, \"ion-input\", 8);\n      i0.ɵɵtwoWayListener(\"ngModelChange\", function LoginPage_Template_ion_input_ngModelChange_17_listener($event) {\n        i0.ɵɵtwoWayBindingSet(ctx.phoneNumber, $event) || (ctx.phoneNumber = $event);\n        return $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(18, \"ion-item\")(19, \"ion-label\", 7);\n      i0.ɵɵtext(20, \"Contrase\\u00F1a\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(21, \"ion-input\", 9);\n      i0.ɵɵtwoWayListener(\"ngModelChange\", function LoginPage_Template_ion_input_ngModelChange_21_listener($event) {\n        i0.ɵɵtwoWayBindingSet(ctx.password, $event) || (ctx.password = $event);\n        return $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(22, \"div\", 10)(23, \"a\", 11);\n      i0.ɵɵlistener(\"click\", function LoginPage_Template_a_click_23_listener() {\n        return ctx.recoverPassword();\n      });\n      i0.ɵɵtext(24, \"\\u00BFOlvidaste tu contrase\\u00F1a?\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(25, \"ion-button\", 12);\n      i0.ɵɵtext(26, \"ENTRAR\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(27, \"ion-button\", 13);\n      i0.ɵɵtext(28, \" REGISTRARTE \");\n      i0.ɵɵelementEnd()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(17);\n      i0.ɵɵtwoWayProperty(\"ngModel\", ctx.phoneNumber);\n      i0.ɵɵadvance(4);\n      i0.ɵɵtwoWayProperty(\"ngModel\", ctx.password);\n    }\n  },\n  dependencies: [i4.ɵNgNoValidate, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm, i3.IonButton, i3.IonContent, i3.IonHeader, i3.IonInput, i3.IonItem, i3.IonLabel, i3.IonTitle, i3.IonToolbar, i3.TextValueAccessor, i3.RouterLinkDelegate, i2.RouterLink],\n  styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"names":["RecuperarContrasenaModalComponent","LoginPage","constructor","apiService","router","toastController","modalController","phoneNumber","password","recoverPassword","_this","_asyncToGenerator","modal","create","component","present","login","_this2","loginData","console","log","JSON","stringify","subscribe","_ref","response","message","localStorage","setItem","fullName","navigate","toast","duration","color","_x","apply","arguments","i0","ɵɵdirectiveInject","i1","ApiService","i2","Router","i3","ToastController","ModalController","selectors","decls","vars","consts","template","LoginPage_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵelement","ɵɵlistener","LoginPage_Template_form_ngSubmit_13_listener","ɵɵtwoWayListener","LoginPage_Template_ion_input_ngModelChange_17_listener","$event","ɵɵtwoWayBindingSet","LoginPage_Template_ion_input_ngModelChange_21_listener","LoginPage_Template_a_click_23_listener","ɵɵadvance","ɵɵtwoWayProperty"],"sources":["C:\\Users\\a.campos\\source\\repos\\ionicaxion\\src\\app\\login\\login.page.ts","C:\\Users\\a.campos\\source\\repos\\ionicaxion\\src\\app\\login\\login.page.html"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { Router } from '@angular/router'; // Importa Router\r\nimport { ApiService } from '../services/api.service';\r\nimport { ToastController, ModalController } from '@ionic/angular';\r\nimport { LoginResponse } from '../models/login-response.model'; // Asegúrate de que la ruta sea correcta\r\nimport { RecuperarContrasenaModalComponent } from '../recuperar-contrasena-modal/recuperar-contrasena-modal.component'; // Importa el modal\r\n\r\n\r\n// Define la interfaz aquí\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.page.html',\r\n  styleUrls: ['./login.page.scss'],\r\n})\r\nexport class LoginPage {\r\n  phoneNumber: string = \"\";\r\n  password: string = \"\";\r\n\r\n  constructor(\r\n    private apiService: ApiService,\r\n    private router: Router, // Inyecta Router\r\n    private toastController: ToastController,\r\n    private modalController: ModalController  // Inyecta ToastController\r\n  ) {}\r\n\r\n\r\n  async recoverPassword() {\r\n    const modal = await this.modalController.create({\r\n      component: RecuperarContrasenaModalComponent\r\n    });\r\n    return await modal.present();\r\n  }\r\n\r\n\r\n  async login() {\r\n    const loginData = {\r\n      phoneNumber: this.phoneNumber,\r\n      password: this.password\r\n    };\r\n\r\n\r\n    console.log('LoginData from API:', loginData); // <-- Agregado aquí\r\n\r\n    console.log('Login Data:', JSON.stringify(loginData));\r\n    this.apiService.login(loginData).subscribe(async (response: LoginResponse) => {\r\n      console.log('Response from API:', response);\r\n      if (response && response.message === 'Login successful.') {\r\n        // Almacena el nombre completo del usuario en localStorage\r\n        localStorage.setItem('fullName', response.fullName);\r\n\r\n        this.router.navigate(['/home']); // Navega a la página home\r\n      } else {\r\n        // Muestra un toast con el error\r\n        const toast = await this.toastController.create({\r\n          message: response.message || 'Error al iniciar sesión',\r\n          duration: 2000,\r\n          color: 'danger'\r\n        });\r\n        toast.present();\r\n      }\r\n    });\r\n  }\r\n}\r\n","<ion-header>\r\n  <ion-toolbar style=\"background-color: #D1117E;\">\r\n    <ion-title>Login</ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content style=\"padding: 20px; background-image: url(assets/fondo_general.png);\">\r\n\r\n  <!-- Logo de Axion -->\r\n  <div style=\"text-align: center; margin-bottom: 20px;\">\r\n    <img src=\"assets/logo.png\" alt=\"Logo de Axion\" style=\"max-width: 100%; height: auto;\"/>\r\n    <h2 style=\"color: white; margin: 0;\">SANTA LUCÍA</h2>\r\n    <h3 style=\"color: white; margin: 0;\">AXION SHOP</h3>\r\n  </div>\r\n\r\n  <h4 style=\"color: white; text-align: center;\">Bienvenido</h4>\r\n\r\n  <form (ngSubmit)=\"login()\">\r\n    <ion-item>\r\n      <ion-label position=\"floating\">Número de celular</ion-label>\r\n      <ion-input [(ngModel)]=\"phoneNumber\" name=\"phoneNumber\" required></ion-input>\r\n    </ion-item>\r\n    <ion-item>\r\n      <ion-label position=\"floating\">Contraseña</ion-label>\r\n      <ion-input [(ngModel)]=\"password\" name=\"password\" type=\"password\" required></ion-input>\r\n    </ion-item>\r\n\r\n    <!-- Link para recuperar contraseña -->\r\n    <div style=\"text-align: center; margin: 10px 0;\">\r\n      <a href=\"#\" style=\"color: white;\" (click)=\"recoverPassword()\">¿Olvidaste tu contraseña?</a>\r\n    </div>\r\n\r\n    <ion-button expand=\"full\" type=\"submit\" style=\"background-color: black; color: white;\">ENTRAR</ion-button>\r\n\r\n    <!-- Botón para registrarse -->\r\n    <ion-button expand=\"full\" style=\"background-color: #D1117E; color: white;\" routerLink=\"/registro\">\r\n      REGISTRARTE\r\n    </ion-button>\r\n  </form>\r\n</ion-content>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}